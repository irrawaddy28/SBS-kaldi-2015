nohup: ignoring input
local/nnet/train_stackedsoftmax.sh --feature-transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform --hid-layers 0 --learn-rate 0.008 --train-iters 40 --cmvn-opts --norm-means=true --norm-vars=true --delta-opts --delta-order=2 --splice 5 --splice-step 1 --labels-trainf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --labels-crossvf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp --copy-feats false data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 lang-dummy exp/tri3cpt_ali/SW exp/tri3cpt_ali/SW 950 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0
data = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90
		 data_cv = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10
		 lang = lang-dummy
		 alidir = exp/tri3cpt_ali/SW
		 alidir_cv = exp/tri3cpt_ali/SW
		 num_tgt = 950
		 nnet_bottom = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet
		 dir = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0
		 labels_trainf = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# INFO
local/nnet/train_stackedsoftmax.sh : Training Neural Network
	 dir       : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0 
	 Train-set : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/tri3cpt_ali/SW 
	 CV-set    : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 exp/tri3cpt_ali/SW 

### IS CUDA GPU AVAILABLE? 'ifp-48' ###
WARNING (SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2960M, used:107M, total:3068M, free/total:0.964819
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2997M, used:74M, total:3071M, free/total:0.975681
LOG (SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.975681
LOG (SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.975681
LOG (FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2983M, used:88M, total:3071M, free/total:0.971124 version 3.5
LOG (PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
### HURRAY, WE GOT A CUDA GPU FOR COMPUTATION!!! ###

# PREPARING ALIGNMENTS
Using targets '' (by force)
copy-transition-model --binary=false exp/tri3cpt_ali/SW/final.mdl exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.mdl 
LOG (copy-transition-model:main():copy-transition-model.cc:62) Copied transition model.
labels_tr = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp
labels_cv = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# PREPARING FEATURES
Preparing train/cv lists :
  2420 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/train.scp
   282 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/cv.scp
  2702 total
Imported config : cmvn_opts='--norm-means=true --norm-vars=true' delta_opts='--delta-order=2'
Will use CMVN statistics : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp, data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp
add-deltas with --delta-order=2


Getting feature dim before feature transformation: 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/train.scp ark:- 
add-deltas --delta-order=2 ark:- ark:- 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | had nonzero return status 36096
Feature dim is : 120


Create the feature transform for the top nnet: exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform
local/nnet/make_activesoftmax_from_blocksoftmax.sh exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet 950,950 1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform
nnet-initialize /dev/fd/63 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/copy_and_softmax.nnet 
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Copy> <InputDim> 1900 <OutputDim> 950 <BuildVector> 1:950 </BuildVector>
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Softmax> <InputDim> 950 <OutputDim> 950
LOG (nnet-initialize:main():nnet-initialize.cc:64) Written initialized model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/copy_and_softmax.nnet
nnet-concat 'nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |' exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/copy_and_softmax.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |
nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - 
LOG (nnet-copy:main():nnet-copy.cc:86) Written model to -
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/copy_and_softmax.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform


Initializing exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/nnet.proto -> exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/nnet.init ... 


Getting feature dim after feature transformation: 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/train.scp ark:- 
add-deltas --delta-order=2 ark:- ark:- 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- 
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2898M, used:169M, total:3068M, free/total:0.944702
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2899M, used:169M, total:3068M, free/total:0.944743
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2935M, used:136M, total:3071M, free/total:0.955583
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2935M, used:136M, total:3071M, free/total:0.955583
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.955583
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.955583
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.955583
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.955583
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2907M, used:164M, total:3071M, free/total:0.946468 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2907M, used:164M, total:3071M, free/total:0.946468 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform ark:- ark:- | had nonzero return status 36096
Feature dim is : 950
learn rate: 0.008

# RUNNING THE NN-TRAINING SCHEDULER
steps/nnet/train_scheduler.sh --learn-rate 0.008 --randomizer-seed 777 --max-iters 40 --minibatch-size 256 --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/nnet.init ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform ark:- ark:- | ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform ark:- ark:- | scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0

mlp_init=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/nnet.init

feats_tr=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform ark:- ark:- |

feats_cv=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform ark:- ark:- |

labels_tr=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

labels_cv=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

dir=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0

Training Parameters:
 
         mlp init = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/nnet.init

         learn rate = 0.008

         max epochs = 40

         minibatch size = 256

         randomizer size = 32768

         frame weights  = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp

         momentum = 0

         l1-penalty = 0

         l2-penalty = 0

CROSSVAL PRERUN AVG.LOSS 6.8544 (Xent),
ITERATION 01: TRAIN AVG.LOSS 5.4164, (lrate0.008), CROSSVAL AVG.LOSS 5.6365, nnet accepted (nnet_iter01_learnrate0.008_tr5.4164_cv5.6365)
ITERATION 02: TRAIN AVG.LOSS 5.0682, (lrate0.008), CROSSVAL AVG.LOSS 5.4440, nnet accepted (nnet_iter02_learnrate0.008_tr5.0682_cv5.4440)
ITERATION 03: TRAIN AVG.LOSS 4.8373, (lrate0.008), CROSSVAL AVG.LOSS 5.2922, nnet accepted (nnet_iter03_learnrate0.008_tr4.8373_cv5.2922)
ITERATION 04: TRAIN AVG.LOSS 4.6603, (lrate0.008), CROSSVAL AVG.LOSS 5.1720, nnet accepted (nnet_iter04_learnrate0.008_tr4.6603_cv5.1720)
ITERATION 05: TRAIN AVG.LOSS 4.5187, (lrate0.008), CROSSVAL AVG.LOSS 5.0727, nnet accepted (nnet_iter05_learnrate0.008_tr4.5187_cv5.0727)
ITERATION 06: TRAIN AVG.LOSS 4.4019, (lrate0.008), CROSSVAL AVG.LOSS 4.9882, nnet accepted (nnet_iter06_learnrate0.008_tr4.4019_cv4.9882)
ITERATION 07: TRAIN AVG.LOSS 4.3031, (lrate0.008), CROSSVAL AVG.LOSS 4.9146, nnet accepted (nnet_iter07_learnrate0.008_tr4.3031_cv4.9146)
ITERATION 08: TRAIN AVG.LOSS 4.2181, (lrate0.008), CROSSVAL AVG.LOSS 4.8495, nnet accepted (nnet_iter08_learnrate0.008_tr4.2181_cv4.8495)
ITERATION 09: TRAIN AVG.LOSS 4.1435, (lrate0.008), CROSSVAL AVG.LOSS 4.7910, nnet accepted (nnet_iter09_learnrate0.008_tr4.1435_cv4.7910)
ITERATION 10: TRAIN AVG.LOSS 4.0774, (lrate0.008), CROSSVAL AVG.LOSS 4.7380, nnet accepted (nnet_iter10_learnrate0.008_tr4.0774_cv4.7380)
ITERATION 11: TRAIN AVG.LOSS 4.0181, (lrate0.008), CROSSVAL AVG.LOSS 4.6896, nnet accepted (nnet_iter11_learnrate0.008_tr4.0181_cv4.6896)
ITERATION 12: TRAIN AVG.LOSS 3.9646, (lrate0.008), CROSSVAL AVG.LOSS 4.6452, nnet accepted (nnet_iter12_learnrate0.008_tr3.9646_cv4.6452)
ITERATION 13: TRAIN AVG.LOSS 3.9298, (lrate0.004), CROSSVAL AVG.LOSS 4.6273, nnet accepted (nnet_iter13_learnrate0.004_tr3.9298_cv4.6273)
ITERATION 14: TRAIN AVG.LOSS 3.9131, (lrate0.002), CROSSVAL AVG.LOSS 4.6165, nnet accepted (nnet_iter14_learnrate0.002_tr3.9131_cv4.6165)
ITERATION 15: TRAIN AVG.LOSS 3.9047, (lrate0.001), CROSSVAL AVG.LOSS 4.6095, nnet accepted (nnet_iter15_learnrate0.001_tr3.9047_cv4.6095)
ITERATION 16: TRAIN AVG.LOSS 3.9004, (lrate0.0005), CROSSVAL AVG.LOSS 4.6047, nnet accepted (nnet_iter16_learnrate0.0005_tr3.9004_cv4.6047)
ITERATION 17: TRAIN AVG.LOSS 3.8983, (lrate0.00025), CROSSVAL AVG.LOSS 4.6019, nnet accepted (nnet_iter17_learnrate0.00025_tr3.8983_cv4.6019)
finished, too small rel. improvement .0006167597
Succeeded training the Neural Network : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.nnet
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_dev_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_dev_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_dev_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_dev_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_dev_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_dev_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/dev exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_dev_text_G_SW
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_eval_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l0/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_eval_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_eval_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_eval_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_eval_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
local/nnet/train_stackedsoftmax.sh --feature-transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform --hid-layers 1 --learn-rate 0.008 --train-iters 40 --cmvn-opts --norm-means=true --norm-vars=true --delta-opts --delta-order=2 --splice 5 --splice-step 1 --labels-trainf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --labels-crossvf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp --copy-feats false data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 lang-dummy exp/tri3cpt_ali/SW exp/tri3cpt_ali/SW 950 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_eval_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/eval exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_eval_text_G_SW
data = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90
		 data_cv = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10
		 lang = lang-dummy
		 alidir = exp/tri3cpt_ali/SW
		 alidir_cv = exp/tri3cpt_ali/SW
		 num_tgt = 950
		 nnet_bottom = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet
		 dir = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1
		 labels_trainf = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# INFO
local/nnet/train_stackedsoftmax.sh : Training Neural Network
	 dir       : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1 
	 Train-set : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/tri3cpt_ali/SW 
	 CV-set    : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 exp/tri3cpt_ali/SW 

### IS CUDA GPU AVAILABLE? 'ifp-48' ###
WARNING (SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2960M, used:107M, total:3068M, free/total:0.964819
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2997M, used:74M, total:3071M, free/total:0.975681
LOG (SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.975681
LOG (SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.975681
LOG (FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2983M, used:88M, total:3071M, free/total:0.971124 version 3.5
LOG (PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
### HURRAY, WE GOT A CUDA GPU FOR COMPUTATION!!! ###

# PREPARING ALIGNMENTS
Using targets '' (by force)
copy-transition-model --binary=false exp/tri3cpt_ali/SW/final.mdl exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.mdl 
LOG (copy-transition-model:main():copy-transition-model.cc:62) Copied transition model.
labels_tr = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp
labels_cv = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# PREPARING FEATURES
Preparing train/cv lists :
  2420 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/train.scp
   282 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/cv.scp
  2702 total
Imported config : cmvn_opts='--norm-means=true --norm-vars=true' delta_opts='--delta-order=2'
Will use CMVN statistics : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp, data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp
add-deltas with --delta-order=2


Getting feature dim before feature transformation: 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/train.scp ark:- 
add-deltas --delta-order=2 ark:- ark:- 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | had nonzero return status 36096
Feature dim is : 120


Create the feature transform for the top nnet: exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform
local/nnet/make_activesoftmax_from_blocksoftmax.sh exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet 950,950 1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform
nnet-initialize /dev/fd/63 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/copy_and_softmax.nnet 
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Copy> <InputDim> 1900 <OutputDim> 950 <BuildVector> 1:950 </BuildVector>
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Softmax> <InputDim> 950 <OutputDim> 950
LOG (nnet-initialize:main():nnet-initialize.cc:64) Written initialized model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/copy_and_softmax.nnet
nnet-concat 'nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |' exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/copy_and_softmax.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |
nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - 
LOG (nnet-copy:main():nnet-copy.cc:86) Written model to -
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/copy_and_softmax.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform


Initializing exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/nnet.proto -> exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/nnet.init ... 


Getting feature dim after feature transformation: 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/train.scp ark:- 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- 
add-deltas --delta-order=2 ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform ark:- ark:- 
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2954M, used:114M, total:3068M, free/total:0.962793
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2904M, used:164M, total:3068M, free/total:0.946341
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2989M, used:81M, total:3071M, free/total:0.973327
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2940M, used:131M, total:3071M, free/total:0.957135
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.973327
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.957135
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.973327
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.957135
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2912M, used:159M, total:3071M, free/total:0.948095 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2839M, used:232M, total:3071M, free/total:0.924331 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform ark:- ark:- | had nonzero return status 36096
Feature dim is : 950
learn rate: 0.008

# RUNNING THE NN-TRAINING SCHEDULER
steps/nnet/train_scheduler.sh --learn-rate 0.008 --randomizer-seed 777 --max-iters 40 --minibatch-size 256 --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/nnet.init ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform ark:- ark:- | ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform ark:- ark:- | scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1

mlp_init=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/nnet.init

feats_tr=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform ark:- ark:- |

feats_cv=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform ark:- ark:- |

labels_tr=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

labels_cv=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

dir=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1

Training Parameters:
 
         mlp init = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/nnet.init

         learn rate = 0.008

         max epochs = 40

         minibatch size = 256

         randomizer size = 32768

         frame weights  = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp

         momentum = 0

         l1-penalty = 0

         l2-penalty = 0

CROSSVAL PRERUN AVG.LOSS 7.3076 (Xent),
ITERATION 01: TRAIN AVG.LOSS 5.5459, (lrate0.008), CROSSVAL AVG.LOSS 5.7273, nnet accepted (nnet_iter01_learnrate0.008_tr5.5459_cv5.7273)
ITERATION 02: TRAIN AVG.LOSS 5.0450, (lrate0.008), CROSSVAL AVG.LOSS 5.0981, nnet accepted (nnet_iter02_learnrate0.008_tr5.0450_cv5.0981)
ITERATION 03: TRAIN AVG.LOSS 4.2996, (lrate0.008), CROSSVAL AVG.LOSS 4.4781, nnet accepted (nnet_iter03_learnrate0.008_tr4.2996_cv4.4781)
ITERATION 04: TRAIN AVG.LOSS 3.7476, (lrate0.008), CROSSVAL AVG.LOSS 4.0968, nnet accepted (nnet_iter04_learnrate0.008_tr3.7476_cv4.0968)
ITERATION 05: TRAIN AVG.LOSS 3.4473, (lrate0.008), CROSSVAL AVG.LOSS 3.9173, nnet accepted (nnet_iter05_learnrate0.008_tr3.4473_cv3.9173)
ITERATION 06: TRAIN AVG.LOSS 3.2689, (lrate0.008), CROSSVAL AVG.LOSS 3.7514, nnet accepted (nnet_iter06_learnrate0.008_tr3.2689_cv3.7514)
ITERATION 07: TRAIN AVG.LOSS 3.1530, (lrate0.008), CROSSVAL AVG.LOSS 3.6404, nnet accepted (nnet_iter07_learnrate0.008_tr3.1530_cv3.6404)
ITERATION 08: TRAIN AVG.LOSS 3.0716, (lrate0.008), CROSSVAL AVG.LOSS 3.5703, nnet accepted (nnet_iter08_learnrate0.008_tr3.0716_cv3.5703)
ITERATION 09: TRAIN AVG.LOSS 3.0103, (lrate0.008), CROSSVAL AVG.LOSS 3.5148, nnet accepted (nnet_iter09_learnrate0.008_tr3.0103_cv3.5148)
ITERATION 10: TRAIN AVG.LOSS 2.9618, (lrate0.008), CROSSVAL AVG.LOSS 3.4706, nnet accepted (nnet_iter10_learnrate0.008_tr2.9618_cv3.4706)
ITERATION 11: TRAIN AVG.LOSS 2.9216, (lrate0.008), CROSSVAL AVG.LOSS 3.4338, nnet accepted (nnet_iter11_learnrate0.008_tr2.9216_cv3.4338)
ITERATION 12: TRAIN AVG.LOSS 2.8878, (lrate0.008), CROSSVAL AVG.LOSS 3.4024, nnet accepted (nnet_iter12_learnrate0.008_tr2.8878_cv3.4024)
ITERATION 13: TRAIN AVG.LOSS 2.8420, (lrate0.004), CROSSVAL AVG.LOSS 3.3516, nnet accepted (nnet_iter13_learnrate0.004_tr2.8420_cv3.3516)
ITERATION 14: TRAIN AVG.LOSS 2.8292, (lrate0.002), CROSSVAL AVG.LOSS 3.3466, nnet accepted (nnet_iter14_learnrate0.002_tr2.8292_cv3.3466)
ITERATION 15: TRAIN AVG.LOSS 2.8263, (lrate0.001), CROSSVAL AVG.LOSS 3.3485, nnet rejected (nnet_iter15_learnrate0.001_tr2.8263_cv3.3485_rejected)
finished, too small rel. improvement 0
Succeeded training the Neural Network : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.nnet
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_dev_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_dev_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_dev_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_dev_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_dev_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_dev_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/dev exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_dev_text_G_SW
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_eval_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l1/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_eval_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_eval_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_eval_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_eval_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
local/nnet/train_stackedsoftmax.sh --feature-transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform --hid-layers 2 --learn-rate 0.008 --train-iters 40 --cmvn-opts --norm-means=true --norm-vars=true --delta-opts --delta-order=2 --splice 5 --splice-step 1 --labels-trainf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --labels-crossvf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp --copy-feats false data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 lang-dummy exp/tri3cpt_ali/SW exp/tri3cpt_ali/SW 950 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_eval_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/eval exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_eval_text_G_SW
data = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90
		 data_cv = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10
		 lang = lang-dummy
		 alidir = exp/tri3cpt_ali/SW
		 alidir_cv = exp/tri3cpt_ali/SW
		 num_tgt = 950
		 nnet_bottom = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet
		 dir = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2
		 labels_trainf = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# INFO
local/nnet/train_stackedsoftmax.sh : Training Neural Network
	 dir       : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2 
	 Train-set : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/tri3cpt_ali/SW 
	 CV-set    : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 exp/tri3cpt_ali/SW 

### IS CUDA GPU AVAILABLE? 'ifp-48' ###
WARNING (SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2960M, used:107M, total:3068M, free/total:0.964819
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2997M, used:74M, total:3071M, free/total:0.975681
LOG (SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.975681
LOG (SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.975681
LOG (FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2983M, used:88M, total:3071M, free/total:0.971124 version 3.5
LOG (PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
### HURRAY, WE GOT A CUDA GPU FOR COMPUTATION!!! ###

# PREPARING ALIGNMENTS
Using targets '' (by force)
copy-transition-model --binary=false exp/tri3cpt_ali/SW/final.mdl exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.mdl 
LOG (copy-transition-model:main():copy-transition-model.cc:62) Copied transition model.
labels_tr = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp
labels_cv = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# PREPARING FEATURES
Preparing train/cv lists :
  2420 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/train.scp
   282 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/cv.scp
  2702 total
Imported config : cmvn_opts='--norm-means=true --norm-vars=true' delta_opts='--delta-order=2'
Will use CMVN statistics : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp, data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp
add-deltas with --delta-order=2


Getting feature dim before feature transformation: 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/train.scp ark:- 
add-deltas --delta-order=2 ark:- ark:- 
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | had nonzero return status 36096
Feature dim is : 120


Create the feature transform for the top nnet: exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform
local/nnet/make_activesoftmax_from_blocksoftmax.sh exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet 950,950 1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform
nnet-initialize /dev/fd/63 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/copy_and_softmax.nnet 
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Copy> <InputDim> 1900 <OutputDim> 950 <BuildVector> 1:950 </BuildVector>
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Softmax> <InputDim> 950 <OutputDim> 950
LOG (nnet-initialize:main():nnet-initialize.cc:64) Written initialized model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/copy_and_softmax.nnet
nnet-concat 'nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |' exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/copy_and_softmax.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |
nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - 
LOG (nnet-copy:main():nnet-copy.cc:86) Written model to -
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/copy_and_softmax.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform


Initializing exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/nnet.proto -> exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/nnet.init ... 


Getting feature dim after feature transformation: 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform ark:- ark:- 
add-deltas --delta-order=2 ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/train.scp ark:- 
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2956M, used:111M, total:3068M, free/total:0.963528
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2904M, used:164M, total:3068M, free/total:0.946381
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2988M, used:82M, total:3071M, free/total:0.972999
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2940M, used:131M, total:3071M, free/total:0.95726
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.972999
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.95726
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.972999
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.95726
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2912M, used:159M, total:3071M, free/total:0.948095 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2902M, used:169M, total:3071M, free/total:0.944881 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform ark:- ark:- | had nonzero return status 36096
Feature dim is : 950
learn rate: 0.008

# RUNNING THE NN-TRAINING SCHEDULER
steps/nnet/train_scheduler.sh --learn-rate 0.008 --randomizer-seed 777 --max-iters 40 --minibatch-size 256 --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/nnet.init ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform ark:- ark:- | ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform ark:- ark:- | scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2

mlp_init=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/nnet.init

feats_tr=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform ark:- ark:- |

feats_cv=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform ark:- ark:- |

labels_tr=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

labels_cv=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

dir=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2

Training Parameters:
 
         mlp init = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/nnet.init

         learn rate = 0.008

         max epochs = 40

         minibatch size = 256

         randomizer size = 32768

         frame weights  = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp

         momentum = 0

         l1-penalty = 0

         l2-penalty = 0

CROSSVAL PRERUN AVG.LOSS 7.3232 (Xent),
ITERATION 01: TRAIN AVG.LOSS 5.4770, (lrate0.008), CROSSVAL AVG.LOSS 5.5122, nnet accepted (nnet_iter01_learnrate0.008_tr5.4770_cv5.5122)
ITERATION 02: local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/eval exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_eval_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
TRAIN AVG.LOSS 4.8139, (lrate0.008), CROSSVAL AVG.LOSS 4.8429, nnet accepted (nnet_iter02_learnrate0.008_tr4.8139_cv4.8429)
ITERATION 03: TRAIN AVG.LOSS 4.1388, (lrate0.008), CROSSVAL AVG.LOSS 4.2637, nnet accepted (nnet_iter03_learnrate0.008_tr4.1388_cv4.2637)
ITERATION 04: TRAIN AVG.LOSS 3.6317, (lrate0.008), CROSSVAL AVG.LOSS 3.8787, nnet accepted (nnet_iter04_learnrate0.008_tr3.6317_cv3.8787)
ITERATION 05: TRAIN AVG.LOSS 3.3535, (lrate0.008), CROSSVAL AVG.LOSS 3.7006, nnet accepted (nnet_iter05_learnrate0.008_tr3.3535_cv3.7006)
ITERATION 06: TRAIN AVG.LOSS 3.1991, (lrate0.008), CROSSVAL AVG.LOSS 3.5811, nnet accepted (nnet_iter06_learnrate0.008_tr3.1991_cv3.5811)
ITERATION 07: TRAIN AVG.LOSS 3.0940, (lrate0.008), CROSSVAL AVG.LOSS 3.4906, nnet accepted (nnet_iter07_learnrate0.008_tr3.0940_cv3.4906)
ITERATION 08: TRAIN AVG.LOSS 3.0144, (lrate0.008), CROSSVAL AVG.LOSS 3.4222, nnet accepted (nnet_iter08_learnrate0.008_tr3.0144_cv3.4222)
ITERATION 09: TRAIN AVG.LOSS 2.9496, (lrate0.008), CROSSVAL AVG.LOSS 3.3704, nnet accepted (nnet_iter09_learnrate0.008_tr2.9496_cv3.3704)
ITERATION 10: local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/dev exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l0_block_1_dev_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
TRAIN AVG.LOSS 2.8960, (lrate0.008), CROSSVAL AVG.LOSS 3.3287, nnet accepted (nnet_iter10_learnrate0.008_tr2.8960_cv3.3287)
ITERATION 11: local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/eval exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_eval_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
TRAIN AVG.LOSS 2.8522, (lrate0.008), CROSSVAL AVG.LOSS 3.2943, nnet accepted (nnet_iter11_learnrate0.008_tr2.8522_cv3.2943)
ITERATION 12: TRAIN AVG.LOSS 2.8163, (lrate0.008), CROSSVAL AVG.LOSS 3.2664, nnet accepted (nnet_iter12_learnrate0.008_tr2.8163_cv3.2664)
ITERATION 13: TRAIN AVG.LOSS 2.7548, (lrate0.004), CROSSVAL AVG.LOSS 3.2444, nnet accepted (nnet_iter13_learnrate0.004_tr2.7548_cv3.2444)
ITERATION 14: TRAIN AVG.LOSS 2.7359, (lrate0.002), CROSSVAL AVG.LOSS 3.2510, nnet rejected (nnet_iter14_learnrate0.002_tr2.7359_cv3.2510_rejected)
finished, too small rel. improvement 0
Succeeded training the Neural Network : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.nnet
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_dev_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_dev_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_dev_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_dev_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_dev_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_dev_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/dev exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_dev_text_G_SW
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_eval_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l2/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_eval_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_eval_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_eval_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_eval_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
local/nnet/train_stackedsoftmax.sh --feature-transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform --hid-layers 3 --learn-rate 0.008 --train-iters 40 --cmvn-opts --norm-means=true --norm-vars=true --delta-opts --delta-order=2 --splice 5 --splice-step 1 --labels-trainf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --labels-crossvf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp --copy-feats false data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 lang-dummy exp/tri3cpt_ali/SW exp/tri3cpt_ali/SW 950 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_eval_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/eval exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_eval_text_G_SW
data = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90
		 data_cv = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10
		 lang = lang-dummy
		 alidir = exp/tri3cpt_ali/SW
		 alidir_cv = exp/tri3cpt_ali/SW
		 num_tgt = 950
		 nnet_bottom = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet
		 dir = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3
		 labels_trainf = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# INFO
local/nnet/train_stackedsoftmax.sh : Training Neural Network
	 dir       : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3 
	 Train-set : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/tri3cpt_ali/SW 
	 CV-set    : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 exp/tri3cpt_ali/SW 

### IS CUDA GPU AVAILABLE? 'ifp-48' ###
WARNING (SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2960M, used:107M, total:3068M, free/total:0.964819
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2997M, used:74M, total:3071M, free/total:0.975681
LOG (SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.975681
LOG (SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.975681
LOG (FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2983M, used:88M, total:3071M, free/total:0.971124 version 3.5
LOG (PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
### HURRAY, WE GOT A CUDA GPU FOR COMPUTATION!!! ###

# PREPARING ALIGNMENTS
Using targets '' (by force)
copy-transition-model --binary=false exp/tri3cpt_ali/SW/final.mdl exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.mdl 
LOG (copy-transition-model:main():copy-transition-model.cc:62) Copied transition model.
labels_tr = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp
labels_cv = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# PREPARING FEATURES
Preparing train/cv lists :
  2420 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/train.scp
   282 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/cv.scp
  2702 total
Imported config : cmvn_opts='--norm-means=true --norm-vars=true' delta_opts='--delta-order=2'
Will use CMVN statistics : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp, data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp
add-deltas with --delta-order=2


Getting feature dim before feature transformation: 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/train.scp ark:- 
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | had nonzero return status 36096
Feature dim is : 120


Create the feature transform for the top nnet: exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform
local/nnet/make_activesoftmax_from_blocksoftmax.sh exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet 950,950 1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform
nnet-initialize /dev/fd/63 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/copy_and_softmax.nnet 
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Copy> <InputDim> 1900 <OutputDim> 950 <BuildVector> 1:950 </BuildVector>
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Softmax> <InputDim> 950 <OutputDim> 950
LOG (nnet-initialize:main():nnet-initialize.cc:64) Written initialized model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/copy_and_softmax.nnet
nnet-concat 'nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |' exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/copy_and_softmax.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |
nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - 
LOG (nnet-copy:main():nnet-copy.cc:86) Written model to -
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/copy_and_softmax.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform


Initializing exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/nnet.proto -> exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/nnet.init ... 


Getting feature dim after feature transformation: 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/train.scp ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
add-deltas --delta-order=2 ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform ark:- ark:- 
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2956M, used:111M, total:3068M, free/total:0.963528
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2904M, used:164M, total:3068M, free/total:0.946509
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2993M, used:78M, total:3071M, free/total:0.974389
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2940M, used:131M, total:3071M, free/total:0.957345
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.974389
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.957345
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.974389
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.957345
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2910M, used:161M, total:3071M, free/total:0.947444 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2902M, used:169M, total:3071M, free/total:0.944881 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform ark:- ark:- | had nonzero return status 36096
Feature dim is : 950
learn rate: 0.008

# RUNNING THE NN-TRAINING SCHEDULER
steps/nnet/train_scheduler.sh --learn-rate 0.008 --randomizer-seed 777 --max-iters 40 --minibatch-size 256 --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/nnet.init ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform ark:- ark:- | ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform ark:- ark:- | scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3

mlp_init=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/nnet.init

feats_tr=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform ark:- ark:- |

feats_cv=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform ark:- ark:- |

labels_tr=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

labels_cv=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

dir=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3

Training Parameters:
 
         mlp init = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/nnet.init

         learn rate = 0.008

         max epochs = 40

         minibatch size = 256

         randomizer size = 32768

         frame weights  = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp

         momentum = 0

         l1-penalty = 0

         l2-penalty = 0

CROSSVAL PRERUN AVG.LOSS 7.1593 (Xent),
ITERATION 01: local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/dev exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l1_block_1_dev_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
TRAIN AVG.LOSS 5.6350, (lrate0.008), CROSSVAL AVG.LOSS 5.6916, nnet accepted (nnet_iter01_learnrate0.008_tr5.6350_cv5.6916)
ITERATION 02: TRAIN AVG.LOSS 5.1578, (lrate0.008), CROSSVAL AVG.LOSS 5.3108, nnet accepted (nnet_iter02_learnrate0.008_tr5.1578_cv5.3108)
ITERATION 03: TRAIN AVG.LOSS 4.7923, (lrate0.008), CROSSVAL AVG.LOSS 4.8595, nnet accepted (nnet_iter03_learnrate0.008_tr4.7923_cv4.8595)
ITERATION 04: TRAIN AVG.LOSS 4.3951, (lrate0.008), CROSSVAL AVG.LOSS 4.5673, nnet accepted (nnet_iter04_learnrate0.008_tr4.3951_cv4.5673)
ITERATION 05: TRAIN AVG.LOSS 3.9608, (lrate0.008), CROSSVAL AVG.LOSS 4.1732, nnet accepted (nnet_iter05_learnrate0.008_tr3.9608_cv4.1732)
ITERATION 06: TRAIN AVG.LOSS 3.6236, (lrate0.008), CROSSVAL AVG.LOSS 3.8771, nnet accepted (nnet_iter06_learnrate0.008_tr3.6236_cv3.8771)
ITERATION 07: TRAIN AVG.LOSS 3.3939, (lrate0.008), CROSSVAL AVG.LOSS 3.7142, nnet accepted (nnet_iter07_learnrate0.008_tr3.3939_cv3.7142)
ITERATION 08: TRAIN AVG.LOSS 3.2608, (lrate0.008), CROSSVAL AVG.LOSS 3.6055, nnet accepted (nnet_iter08_learnrate0.008_tr3.2608_cv3.6055)
ITERATION 09: TRAIN AVG.LOSS 3.1666, (lrate0.008), CROSSVAL AVG.LOSS 3.5385, nnet accepted (nnet_iter09_learnrate0.008_tr3.1666_cv3.5385)
ITERATION 10: TRAIN AVG.LOSS 3.1016, (lrate0.008), CROSSVAL AVG.LOSS 3.4984, nnet accepted (nnet_iter10_learnrate0.008_tr3.1016_cv3.4984)
ITERATION 11: local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/eval exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_eval_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
TRAIN AVG.LOSS 3.0499, (lrate0.008), CROSSVAL AVG.LOSS 3.4696, nnet accepted (nnet_iter11_learnrate0.008_tr3.0499_cv3.4696)
ITERATION 12: TRAIN AVG.LOSS 2.9684, (lrate0.004), CROSSVAL AVG.LOSS 3.4275, nnet accepted (nnet_iter12_learnrate0.004_tr2.9684_cv3.4275)
ITERATION 13: TRAIN AVG.LOSS 2.9418, (lrate0.002), CROSSVAL AVG.LOSS 3.4170, nnet accepted (nnet_iter13_learnrate0.002_tr2.9418_cv3.4170)
ITERATION 14: TRAIN AVG.LOSS 2.9323, (lrate0.001), CROSSVAL AVG.LOSS 3.4185, nnet rejected (nnet_iter14_learnrate0.001_tr2.9323_cv3.4185_rejected)
finished, too small rel. improvement 0
Succeeded training the Neural Network : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.nnet
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_dev_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_dev_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_dev_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_dev_text_G_SW'
local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/dev exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l2_block_1_dev_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_dev_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_dev_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/dev exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_dev_text_G_SW
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_eval_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l3/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_eval_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_eval_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_eval_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_eval_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
local/nnet/train_stackedsoftmax.sh --feature-transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform --hid-layers 4 --learn-rate 0.008 --train-iters 40 --cmvn-opts --norm-means=true --norm-vars=true --delta-opts --delta-order=2 --splice 5 --splice-step 1 --labels-trainf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --labels-crossvf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp --copy-feats false data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 lang-dummy exp/tri3cpt_ali/SW exp/tri3cpt_ali/SW 950 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_eval_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/eval exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_eval_text_G_SW
data = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90
		 data_cv = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10
		 lang = lang-dummy
		 alidir = exp/tri3cpt_ali/SW
		 alidir_cv = exp/tri3cpt_ali/SW
		 num_tgt = 950
		 nnet_bottom = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet
		 dir = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4
		 labels_trainf = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# INFO
local/nnet/train_stackedsoftmax.sh : Training Neural Network
	 dir       : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4 
	 Train-set : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/tri3cpt_ali/SW 
	 CV-set    : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 exp/tri3cpt_ali/SW 

### IS CUDA GPU AVAILABLE? 'ifp-48' ###
WARNING (SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2960M, used:107M, total:3068M, free/total:0.964819
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2997M, used:74M, total:3071M, free/total:0.975681
LOG (SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.975681
LOG (SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.975681
LOG (FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2983M, used:88M, total:3071M, free/total:0.971124 version 3.5
LOG (PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
### HURRAY, WE GOT A CUDA GPU FOR COMPUTATION!!! ###

# PREPARING ALIGNMENTS
Using targets '' (by force)
copy-transition-model --binary=false exp/tri3cpt_ali/SW/final.mdl exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.mdl 
LOG (copy-transition-model:main():copy-transition-model.cc:62) Copied transition model.
labels_tr = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp
labels_cv = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# PREPARING FEATURES
Preparing train/cv lists :
  2420 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/train.scp
   282 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/cv.scp
  2702 total
Imported config : cmvn_opts='--norm-means=true --norm-vars=true' delta_opts='--delta-order=2'
Will use CMVN statistics : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp, data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp
add-deltas with --delta-order=2


Getting feature dim before feature transformation: 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/train.scp ark:- 
add-deltas --delta-order=2 ark:- ark:- 
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | had nonzero return status 36096
Feature dim is : 120


Create the feature transform for the top nnet: exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform
local/nnet/make_activesoftmax_from_blocksoftmax.sh exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet 950,950 1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform
nnet-initialize /dev/fd/63 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/copy_and_softmax.nnet 
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Copy> <InputDim> 1900 <OutputDim> 950 <BuildVector> 1:950 </BuildVector>
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Softmax> <InputDim> 950 <OutputDim> 950
LOG (nnet-initialize:main():nnet-initialize.cc:64) Written initialized model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/copy_and_softmax.nnet
nnet-concat 'nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |' exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/copy_and_softmax.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |
nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - 
LOG (nnet-copy:main():nnet-copy.cc:86) Written model to -
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/copy_and_softmax.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform


Initializing exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/nnet.proto -> exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/nnet.init ... 


Getting feature dim after feature transformation: 
add-deltas --delta-order=2 ark:- ark:- 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/train.scp ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform ark:- ark:- 
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2952M, used:116M, total:3068M, free/total:0.962139
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2903M, used:164M, total:3068M, free/total:0.946255
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2992M, used:79M, total:3071M, free/total:0.974062
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2940M, used:131M, total:3071M, free/total:0.957177
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.974062
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 0 (automatically), mem_ratio: 0.962139
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.974062
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 0 free mem ratio: 0.962139
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [0]: GeForce GTX 780	free:2946M, used:121M, total:3068M, free/total:0.960256 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2983M, used:88M, total:3071M, free/total:0.971124 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform ark:- ark:- | had nonzero return status 36096
Feature dim is : 950
learn rate: 0.008

# RUNNING THE NN-TRAINING SCHEDULER
steps/nnet/train_scheduler.sh --learn-rate 0.008 --randomizer-seed 777 --max-iters 40 --minibatch-size 256 --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/nnet.init ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform ark:- ark:- | ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform ark:- ark:- | scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4

mlp_init=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/nnet.init

feats_tr=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform ark:- ark:- |

feats_cv=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform ark:- ark:- |

labels_tr=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

labels_cv=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

dir=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4

Training Parameters:
 
         mlp init = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/nnet.init

         learn rate = 0.008

         max epochs = 40

         minibatch size = 256

         randomizer size = 32768

         frame weights  = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp

         momentum = 0

         l1-penalty = 0

         l2-penalty = 0

CROSSVAL PRERUN AVG.LOSS 7.2625 (Xent),
ITERATION 01: TRAIN AVG.LOSS 5.7800, (lrate0.008), CROSSVAL AVG.LOSS 5.8469, nnet accepted (nnet_iter01_learnrate0.008_tr5.7800_cv5.8469)
ITERATION 02: TRAIN AVG.LOSS 5.3307, (lrate0.008), CROSSVAL AVG.LOSS 5.4045, nnet accepted (nnet_iter02_learnrate0.008_tr5.3307_cv5.4045)
ITERATION 03: TRAIN AVG.LOSS 5.0731, (lrate0.008), CROSSVAL AVG.LOSS 5.2934, nnet accepted (nnet_iter03_learnrate0.008_tr5.0731_cv5.2934)
ITERATION 04: TRAIN AVG.LOSS 4.9497, (lrate0.008), CROSSVAL AVG.LOSS 5.1576, nnet accepted (nnet_iter04_learnrate0.008_tr4.9497_cv5.1576)
ITERATION 05: TRAIN AVG.LOSS 4.6013, (lrate0.008), CROSSVAL AVG.LOSS 4.7605, nnet accepted (nnet_iter05_learnrate0.008_tr4.6013_cv4.7605)
ITERATION 06: TRAIN AVG.LOSS 4.3977, (lrate0.008), CROSSVAL AVG.LOSS 4.6668, nnet accepted (nnet_iter06_learnrate0.008_tr4.3977_cv4.6668)
ITERATION 07: TRAIN AVG.LOSS 4.1699, (lrate0.008), CROSSVAL AVG.LOSS 4.3055, nnet accepted (nnet_iter07_learnrate0.008_tr4.1699_cv4.3055)
ITERATION 08: TRAIN AVG.LOSS 3.8339, (lrate0.008), CROSSVAL AVG.LOSS 4.0195, nnet accepted (nnet_iter08_learnrate0.008_tr3.8339_cv4.0195)
ITERATION 09: TRAIN AVG.LOSS 3.5823, (lrate0.008), CROSSVAL AVG.LOSS 3.8803, nnet accepted (nnet_iter09_learnrate0.008_tr3.5823_cv3.8803)
ITERATION 10: TRAIN AVG.LOSS 3.4465, (lrate0.008), CROSSVAL AVG.LOSS 3.7841, nnet accepted (nnet_iter10_learnrate0.008_tr3.4465_cv3.7841)
ITERATION 11: TRAIN AVG.LOSS 3.3152, (lrate0.008), CROSSVAL AVG.LOSS 3.6976, nnet accepted (nnet_iter11_learnrate0.008_tr3.3152_cv3.6976)
ITERATION 12: local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/eval exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_eval_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
TRAIN AVG.LOSS 3.2273, (lrate0.008), CROSSVAL AVG.LOSS 3.6508, nnet accepted (nnet_iter12_learnrate0.008_tr3.2273_cv3.6508)
ITERATION 13: TRAIN AVG.LOSS 3.1679, (lrate0.008), CROSSVAL AVG.LOSS 3.5938, nnet accepted (nnet_iter13_learnrate0.008_tr3.1679_cv3.5938)
ITERATION 14: TRAIN AVG.LOSS 3.1165, (lrate0.008), CROSSVAL AVG.LOSS 3.5521, nnet accepted (nnet_iter14_learnrate0.008_tr3.1165_cv3.5521)
ITERATION 15: local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/dev exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l3_block_1_dev_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
TRAIN AVG.LOSS 3.0587, (lrate0.008), CROSSVAL AVG.LOSS 3.5184, nnet accepted (nnet_iter15_learnrate0.008_tr3.0587_cv3.5184)
ITERATION 16: TRAIN AVG.LOSS 2.9606, (lrate0.004), CROSSVAL AVG.LOSS 3.4603, nnet accepted (nnet_iter16_learnrate0.004_tr2.9606_cv3.4603)
ITERATION 17: TRAIN AVG.LOSS 2.9247, (lrate0.002), CROSSVAL AVG.LOSS 3.4364, nnet accepted (nnet_iter17_learnrate0.002_tr2.9247_cv3.4364)
ITERATION 18: TRAIN AVG.LOSS 2.9113, (lrate0.001), CROSSVAL AVG.LOSS 3.4304, nnet accepted (nnet_iter18_learnrate0.001_tr2.9113_cv3.4304)
ITERATION 19: TRAIN AVG.LOSS 2.9070, (lrate0.0005), CROSSVAL AVG.LOSS 3.4344, nnet rejected (nnet_iter19_learnrate0.0005_tr2.9070_cv3.4344_rejected)
finished, too small rel. improvement 0
Succeeded training the Neural Network : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.nnet
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_dev_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_dev_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_dev_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_dev_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_dev_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_dev_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/dev exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_dev_text_G_SW
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_eval_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l4/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_eval_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_eval_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_eval_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_eval_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
local/nnet/train_stackedsoftmax.sh --feature-transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform --hid-layers 5 --learn-rate 0.008 --train-iters 40 --cmvn-opts --norm-means=true --norm-vars=true --delta-opts --delta-order=2 --splice 5 --splice-step 1 --labels-trainf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --labels-crossvf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp --copy-feats false data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 lang-dummy exp/tri3cpt_ali/SW exp/tri3cpt_ali/SW 950 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_eval_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/eval exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_eval_text_G_SW
data = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90
		 data_cv = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10
		 lang = lang-dummy
		 alidir = exp/tri3cpt_ali/SW
		 alidir_cv = exp/tri3cpt_ali/SW
		 num_tgt = 950
		 nnet_bottom = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet
		 dir = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5
		 labels_trainf = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# INFO
local/nnet/train_stackedsoftmax.sh : Training Neural Network
	 dir       : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5 
	 Train-set : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/tri3cpt_ali/SW 
	 CV-set    : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 exp/tri3cpt_ali/SW 

### IS CUDA GPU AVAILABLE? 'ifp-48' ###
WARNING (SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2960M, used:107M, total:3068M, free/total:0.964819
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2997M, used:74M, total:3071M, free/total:0.975681
LOG (SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.975681
LOG (SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.975681
LOG (FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2983M, used:88M, total:3071M, free/total:0.971124 version 3.5
LOG (PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
### HURRAY, WE GOT A CUDA GPU FOR COMPUTATION!!! ###

# PREPARING ALIGNMENTS
Using targets '' (by force)
copy-transition-model --binary=false exp/tri3cpt_ali/SW/final.mdl exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.mdl 
LOG (copy-transition-model:main():copy-transition-model.cc:62) Copied transition model.
labels_tr = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp
labels_cv = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# PREPARING FEATURES
Preparing train/cv lists :
  2420 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/train.scp
   282 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/cv.scp
  2702 total
Imported config : cmvn_opts='--norm-means=true --norm-vars=true' delta_opts='--delta-order=2'
Will use CMVN statistics : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp, data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp
add-deltas with --delta-order=2


Getting feature dim before feature transformation: 
add-deltas --delta-order=2 ark:- ark:- 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | had nonzero return status 36096
Feature dim is : 120


Create the feature transform for the top nnet: exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform
local/nnet/make_activesoftmax_from_blocksoftmax.sh exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet 950,950 1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform
nnet-initialize /dev/fd/63 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/copy_and_softmax.nnet 
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Copy> <InputDim> 1900 <OutputDim> 950 <BuildVector> 1:950 </BuildVector>
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Softmax> <InputDim> 950 <OutputDim> 950
LOG (nnet-initialize:main():nnet-initialize.cc:64) Written initialized model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/copy_and_softmax.nnet
nnet-concat 'nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |' exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/copy_and_softmax.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |
nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - 
LOG (nnet-copy:main():nnet-copy.cc:86) Written model to -
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/copy_and_softmax.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform


Initializing exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/nnet.proto -> exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/nnet.init ... 


Getting feature dim after feature transformation: 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/train.scp ark:- 
add-deltas --delta-order=2 ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- 
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2898M, used:169M, total:3068M, free/total:0.944702
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2898M, used:169M, total:3068M, free/total:0.944702
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2935M, used:136M, total:3071M, free/total:0.955583
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2935M, used:136M, total:3071M, free/total:0.955583
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.955583
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.955583
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.955583
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2909M, used:162M, total:3071M, free/total:0.947119 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2895M, used:176M, total:3071M, free/total:0.942561 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform ark:- ark:- | had nonzero return status 36096
Feature dim is : 950
learn rate: 0.008

# RUNNING THE NN-TRAINING SCHEDULER
steps/nnet/train_scheduler.sh --learn-rate 0.008 --randomizer-seed 777 --max-iters 40 --minibatch-size 256 --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/nnet.init ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform ark:- ark:- | ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform ark:- ark:- | scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5

mlp_init=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/nnet.init

feats_tr=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform ark:- ark:- |

feats_cv=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform ark:- ark:- |

labels_tr=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

labels_cv=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

dir=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5

Training Parameters:
 
         mlp init = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/nnet.init

         learn rate = 0.008

         max epochs = 40

         minibatch size = 256

         randomizer size = 32768

         frame weights  = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp

         momentum = 0

         l1-penalty = 0

         l2-penalty = 0

CROSSVAL PRERUN AVG.LOSS 7.5682 (Xent),
ITERATION 01: TRAIN AVG.LOSS 5.8078, (lrate0.008), CROSSVAL AVG.LOSS 6.1206, nnet accepted (nnet_iter01_learnrate0.008_tr5.8078_cv6.1206)
ITERATION 02: TRAIN AVG.LOSS 5.6480, (lrate0.008), CROSSVAL AVG.LOSS 5.7705, nnet accepted (nnet_iter02_learnrate0.008_tr5.6480_cv5.7705)
ITERATION 03: TRAIN AVG.LOSS 5.1923, (lrate0.008), CROSSVAL AVG.LOSS 5.3536, nnet accepted (nnet_iter03_learnrate0.008_tr5.1923_cv5.3536)
ITERATION 04: TRAIN AVG.LOSS 5.0356, (lrate0.008), CROSSVAL AVG.LOSS 5.3003, nnet accepted (nnet_iter04_learnrate0.008_tr5.0356_cv5.3003)
ITERATION 05: TRAIN AVG.LOSS 4.9280, (lrate0.004), CROSSVAL AVG.LOSS 5.2519, nnet accepted (nnet_iter05_learnrate0.004_tr4.9280_cv5.2519)
ITERATION 06: TRAIN AVG.LOSS 4.9037, (lrate0.002), CROSSVAL AVG.LOSS 5.2315, nnet accepted (nnet_iter06_learnrate0.002_tr4.9037_cv5.2315)
ITERATION 07: TRAIN AVG.LOSS 4.8944, (lrate0.001), CROSSVAL AVG.LOSS 5.2343, nnet rejected (nnet_iter07_learnrate0.001_tr4.8944_cv5.2343_rejected)
finished, too small rel. improvement 0
Succeeded training the Neural Network : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.nnet
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_dev_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_dev_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_dev_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_dev_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_dev_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_dev_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/dev exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_dev_text_G_SW
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_eval_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l5/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_eval_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_eval_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_eval_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_eval_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_eval_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/eval exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_eval_text_G_SW
local/nnet/train_stackedsoftmax.sh --feature-transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform --hid-layers 6 --learn-rate 0.008 --train-iters 40 --cmvn-opts --norm-means=true --norm-vars=true --delta-opts --delta-order=2 --splice 5 --splice-step 1 --labels-trainf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --labels-crossvf scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp --copy-feats false data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 lang-dummy exp/tri3cpt_ali/SW exp/tri3cpt_ali/SW 950 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6
data = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90
		 data_cv = data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10
		 lang = lang-dummy
		 alidir = exp/tri3cpt_ali/SW
		 alidir_cv = exp/tri3cpt_ali/SW
		 num_tgt = 950
		 nnet_bottom = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet
		 dir = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6
		 labels_trainf = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# INFO
local/nnet/train_stackedsoftmax.sh : Training Neural Network
	 dir       : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6 
	 Train-set : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/tri3cpt_ali/SW 
	 CV-set    : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10 exp/tri3cpt_ali/SW 

### IS CUDA GPU AVAILABLE? 'ifp-48' ###
WARNING (SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2960M, used:107M, total:3068M, free/total:0.964819
LOG (SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2997M, used:74M, total:3071M, free/total:0.975681
LOG (SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.975681
LOG (SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.975681
LOG (FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2983M, used:88M, total:3071M, free/total:0.971124 version 3.5
LOG (PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
### HURRAY, WE GOT A CUDA GPU FOR COMPUTATION!!! ###

# PREPARING ALIGNMENTS
Using targets '' (by force)
copy-transition-model --binary=false exp/tri3cpt_ali/SW/final.mdl exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.mdl 
LOG (copy-transition-model:main():copy-transition-model.cc:62) Copied transition model.
labels_tr = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp
labels_cv = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

# PREPARING FEATURES
Preparing train/cv lists :
  2420 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/train.scp
   282 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/cv.scp
  2702 total
Imported config : cmvn_opts='--norm-means=true --norm-vars=true' delta_opts='--delta-order=2'
Will use CMVN statistics : data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp, data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp
add-deltas with --delta-order=2


Getting feature dim before feature transformation: 
add-deltas --delta-order=2 ark:- ark:- 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | had nonzero return status 36096
Feature dim is : 120


Create the feature transform for the top nnet: exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform
local/nnet/make_activesoftmax_from_blocksoftmax.sh exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet 950,950 1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform
nnet-initialize /dev/fd/63 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/copy_and_softmax.nnet 
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Copy> <InputDim> 1900 <OutputDim> 950 <BuildVector> 1:950 </BuildVector>
VLOG[1] (nnet-initialize:Init():nnet-nnet.cc:377) <Softmax> <InputDim> 950 <OutputDim> 950
LOG (nnet-initialize:main():nnet-initialize.cc:64) Written initialized model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/copy_and_softmax.nnet
nnet-concat 'nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |' exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/copy_and_softmax.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - |
nnet-copy --remove-last-components=1 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.nnet - 
LOG (nnet-copy:main():nnet-copy.cc:86) Written model to -
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/copy_and_softmax.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform


Initializing exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/nnet.proto -> exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/nnet.init ... 


Getting feature dim after feature transformation: 
apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- 
copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/train.scp ark:- 
nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform ark:- ark:- 
add-deltas --delta-order=2 ark:- ark:- 
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
WARNING (nnet-forward:SelectGpuId():cu-device.cc:158) Suggestion: use 'nvidia-smi -c 1' to set compute exclusive mode
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:280) Selecting from 2 GPUs
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2955M, used:112M, total:3068M, free/total:0.963201
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(0): GeForce GTX 780	free:2903M, used:164M, total:3068M, free/total:0.946257
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2993M, used:78M, total:3071M, free/total:0.974431
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:295) cudaSetDevice(1): GeForce GTX 780	free:2940M, used:131M, total:3071M, free/total:0.957303
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.974431
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:344) Trying to select device: 1 (automatically), mem_ratio: 0.957303
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.974431
LOG (nnet-forward:SelectGpuIdAuto():cu-device.cc:363) Success selecting device 1 free mem ratio: 0.957303
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2911M, used:160M, total:3071M, free/total:0.94777 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
LOG (nnet-forward:FinalizeActiveGpu():cu-device.cc:202) The active GPU is [1]: GeForce GTX 780	free:2839M, used:232M, total:3071M, free/total:0.924331 version 3.5
LOG (nnet-forward:PrintMemoryUsage():cu-device.cc:379) Memory used: 0 bytes.
WARNING (feat-to-dim:Close():kaldi-io.cc:446) Pipe copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform ark:- ark:- | had nonzero return status 36096
Feature dim is : 950
learn rate: 0.008

# RUNNING THE NN-TRAINING SCHEDULER
steps/nnet/train_scheduler.sh --learn-rate 0.008 --randomizer-seed 777 --max-iters 40 --minibatch-size 256 --frame-weights scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/nnet.init ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform ark:- ark:- | ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform ark:- ark:- | scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6

mlp_init=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/nnet.init

feats_tr=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/train.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform ark:- ark:- |

feats_cv=ark:copy-feats scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/cv.scp ark:- | apply-cmvn --norm-means=true --norm-vars=true --utt2spk=ark:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/utt2spk scp:data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_cv10/cmvn.scp ark:- ark:- | add-deltas --delta-order=2 ark:- ark:- | nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/final.feature_transform ark:- ark:- |  nnet-forward --use-gpu=yes exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform ark:- ark:- |

labels_tr=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

labels_cv=scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/post_block_2.scp

dir=exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6

Training Parameters:
 
         mlp init = exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/nnet.init

         learn rate = 0.008

         max epochs = 40

         minibatch size = 256

         randomizer size = 32768

         frame weights  = scp:exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/ali-post/frame_weights_block_2.scp

         momentum = 0

         l1-penalty = 0

         l2-penalty = 0

CROSSVAL PRERUN AVG.LOSS 7.3108 (Xent),
ITERATION 01: TRAIN AVG.LOSS 5.8067, (lrate0.008), CROSSVAL AVG.LOSS 6.1236, nnet accepted (nnet_iter01_learnrate0.008_tr5.8067_cv6.1236)
ITERATION 02: TRAIN AVG.LOSS 5.7987, (lrate0.008), CROSSVAL AVG.LOSS 6.1545, nnet rejected (nnet_iter02_learnrate0.008_tr5.7987_cv6.1545_rejected)
ITERATION 03: local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/eval exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_eval_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
TRAIN AVG.LOSS 5.8024, (lrate0.004), CROSSVAL AVG.LOSS 6.1527, nnet rejected (nnet_iter03_learnrate0.004_tr5.8024_cv6.1527_rejected)
finished, too small rel. improvement 0
Succeeded training the Neural Network : exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.nnet
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_dev_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_dev_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_dev_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_dev_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_dev_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_dev_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/dev exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_dev_text_G_SW
nnet-concat exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.nnet exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_eval_text_G_SW/final.nnet 
LOG (nnet-concat:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.feature_transform
LOG (nnet-concat:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/stackedsoftmax_l6/final.nnet
LOG (nnet-concat:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_eval_text_G_SW/final.nnet
steps/nnet/make_priors.sh --use-gpu yes data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90 exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_eval_text_G_SW
Accumulating prior stats by forwarding 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90' with 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_eval_text_G_SW'
Succeeded creating prior counts 'exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_eval_text_G_SW/prior_counts' from 'data-fmllr-tri3c/SW/combined_fw0.6_cop0/AM_AR_CA_DI_HG_MD_train_tr90'
steps/nnet/decode.sh --nj 4 --cmd run.pl --config conf/decode_dnn.config --acwt 0.2 --srcdir exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_eval_text_G_SW exp/tri3cpt_ali/SW/graph_text_G_SW data-fmllr-tri3c/SW/SW/eval exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_eval_text_G_SW
local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/dev exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l4_block_1_dev_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/eval exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_eval_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/eval exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_eval_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/dev exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l5_block_1_dev_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
local/score.sh --min-lmwt 2 --max-lmwt 10 --cmd run.pl data-fmllr-tri3c/SW/SW/dev exp/tri3cpt_ali/SW/graph_text_G_SW exp/dnn4_pretrain-dbn_dnn/SW/multisoftmax_pt_fw0.6_cop0/decode_stackedsoftmax_l6_block_1_dev_text_G_SW
local/score.sh: scoring with word insertion penalty=0.0,0.5,1.0
